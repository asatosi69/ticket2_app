<br>
<br>
<%= link_to("チケット予約を登録する", new_ticket_path) %>
<br>
<br>

<%= form_with(scope: :search, url: tickets_path, method: :get, local: true) do |form| %>

   <%= form.label(:seller_id, Ticket.human_attribute_name(:seller_id)) %>

   <% if current_seller.admin_flag? %>
     <%= form.collection_select(:seller_id, Seller.all, :id, :name, selected: @search_params[:seller_id], include_blank: t('helpers.select.include_blank')) %>
   <% else %>
     <%= form.collection_select(:seller_id, Seller.where(id: current_seller.id), :id, :name, include_blank: t('helpers.select.include_blank')) %>
   <% end %>

   <%= form.label(:stage_id, Ticket.human_attribute_name(:stage_id)) %>
   <%= form.collection_select(:stage_id, Stage.all, :id, :stage, selected: @search_params[:stage_id], include_blank: t('helpers.select.include_blank')) %>

   <%= form.label(:kind_id, Ticket.human_attribute_name(:kind_id)) %>
   <%= form.collection_select(:kind_id, Kind.all, :id, :kind, selected: @search_params[:kind_id], include_blank: t('helpers.select.include_blank')) %>

   <%= form.label(:payment_id, Ticket.human_attribute_name(:payment_id)) %>
   <%= form.collection_select(:payment_id, Payment.all, :id, :payment, selected: @search_params[:payment_id], include_blank: t('helpers.select.include_blank')) %>

   <%= form.submit(t('helpers.submit.search')) %>
<% end %>

<% if @tickets.empty? %>

  <h1>登録されている『チケット予約』はありません</h1>

<% else %>

  <div class="table-responsive">
    <table class="table table-striped table-bordered table-hover">
      <thead>
        <tr>
          <th style="width: 60px"><p class="text-center">詳細</p></th>
          <th style="width: 60px"><p class="text-center">編集</p></th>
          <th style="width: 60px"><p class="text-center">削除</p></th>
          <th><p class="text-center">取扱者</p></th>
          <th><p class="text-center">開演日時</p></th>
          <th><p class="text-center">チケット種別</p></th>
          <th><p class="text-center">支払方法</p></th>
          <th><p class="text-center">チケット枚数</p></th>
          <th><p class="text-center">購入者名</p></th>
          <th><p class="text-center">購入者名フリガナ</p></th>
          <th style="width: 200px"><p class="text-center">購入者Eメール</p></th>
        </tr>
      </thead>

      <tbody>
        <% @tickets.each do |ticket| %>
          <tr>
            <td align="center"><%= button_to '詳細', ticket_path(ticket), {method: "get"} %></td>
            <td align="center"><%= button_to '編集', edit_ticket_path(ticket), {method: "get"} %></td>
            <td align="center"><%= button_to '削除', ticket_path(ticket), {method: "delete"} %></td>
            <td align="center"><%= ticket.seller.name %></td>
            <td align="center"><%= ticket.stage.stage %></td>
            <td align="center"><%= ticket.kind.kind %></td>
            <td align="center"><%= ticket.payment.payment %></td>
            <td align="center"><%= ticket.count %></td>
            <td align="center"><%= ticket.buyer_name %></td>
            <td align="center"><%= ticket.buyer_furigana %></td>
            <td align="center"><%= ticket.buyer_mail %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
