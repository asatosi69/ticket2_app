<h3>『支払方法』管理ページ</h3>
<br>
<br>
<p>『チケット種別』で設定したベースとなる金額を支払方法により前後させたい場合に『変動額』に数字を設定します。</p>
<p>ベースとなる金額より高くする場合には『変動額』に『プラス』の数字を、安くする場合には『マイナス』の数字を入れてください。</p>
<br>
<p>『変動額』設定例</p>
<p>あるチケットの１枚当たりの値段が4200円とします。</p>
<p>前売りが4200円の場合は、支払方法『前売り』の『変動額』は『0』を入れてください。</p>
<p>当日精算が4700円の場合は、支払方法『当日精算』の『変動額』は『500』を入れてください。</p>
<p>招待の場合は、支払方法『招待』の『変動額』は『−4200』を入れてください。</p>
<br>
<p>仕様により、『変動額』に『マイナス』の数字を設定した『支払方法』は『一般客』には選択できません。</p>
<p>ただし、『割引キーワード』が設定されている『支払方法』は選択できます。</p>
<p>ご注意ください。<div style="color:#ff0000;">『変動額』に『マイナス』の数字を設定した『支払方法』は赤字で表示しています。</div></p>
<br>
<br>
<%= link_to("支払方法を登録する", new_payment_path) %>
<br>
<br>

<% if @payments.empty? %>

<h1>登録されている『支払方法』はありません</h1>

<% else %>
<div class="table-responsive">
  <table class="table table-striped table-bordered table-hover" style="table-layout:fixed;width:60%">
  <thead>
    <tr>
      <th style="width: 60px"><p class="text-center">編集</p></th>
      <th style="width: 60px"><p class="text-center">削除</p></th>
      <th><p class="text-center">支払方法</p></th>
      <th><p class="text-center">略称</p></th>
      <th><p class="text-center">変動額</p></th>
      <th><p class="text-center">割引キーワード</p></th>
    </tr>
  </thead>

  <tbody>
    <% @payments.each do |payment| %>
      <tr>
        <td align="center"><%= button_to '編集', edit_payment_path(payment), {method: "get"} %></td>
        <td align="center"><%= button_to '削除', payment_path(payment), {method: "delete"} %></td>
        <% if payment.discount_rate < 0 %>
          <td align="center"><div style="color:#ff0000;"><%= payment.payment %></div></td>
          <td align="center"><div style="color:#ff0000;"><%= payment.abbreviation %></div></td>
          <td align="center"><div style="color:#ff0000;"><%= payment.discount_rate %></div></td>
          <td align="center"><div style="color:#ff0000;"><%= payment.discount_keyword %></div></td>
        <% else %>
           <td align="center"><%= payment.payment %></td>
           <td align="center"><%= payment.abbreviation %></td>
           <td align="center"><%= payment.discount_rate %></td>
           <td align="center"><%= payment.discount_keyword %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
</div>
<% end %>
<br>
<% if @payments.empty? %>
<% else %>
  <p>【参考】各チケット種別の支払方法別料金</p>
  <div class="table-responsive">
    <table class="table table-striped table-bordered table-hover" style="table-layout:fixed;width:35%">
      <tr>
        <td>
        </td>
        <% @payments.each do |payment| %>
          <th class="align-middle">
            <% if payment.discount_rate < 0 %>
              <div align="center" style="color:#ff0000;">
                <p class="text-center"><%= payment.payment %></p>
              </div>
            <% else %>
              <p class="text-center"><%= payment.payment %></p>
            <% end %>
          </th>
        <% end %>
      </tr>
      <% @kinds.each do |kind| %>
        <tr>
          <th class="align-middle">
            <p class="text-center">
              <%= kind.kind %>
            </p>
          </th>
          <% @payments.each do |payment| %>
            <% money = kind.price + payment.discount_rate %>
            <td class="align-middle">
              <% if payment.discount_rate < 0 %>
                <div style="color:#ff0000;">
                  <p class="text-center"><%= money %></p>
                </div>
              <% else %>
                <p class="text-center"><%= money %></p>
              <% end %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </table>
  </div>
<% end %>
<%= link_to :back, :style=>"color:#333333" do %>
  <button>戻る</button>
<% end %>
